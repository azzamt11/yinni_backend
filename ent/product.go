// Code generated by ent, DO NOT EDIT.

package ent

import (
	"encoding/json"
	"fmt"
	"strings"
	"time"
	"yinni_backend/ent/product"

	"entgo.io/ent"
	"entgo.io/ent/dialect/sql"
)

// Product is the model entity for the Product schema.
type Product struct {
	config `json:"-"`
	// ID of the ent.
	ID int `json:"id,omitempty"`
	// CreateTime holds the value of the "create_time" field.
	CreateTime time.Time `json:"create_time,omitempty"`
	// UpdateTime holds the value of the "update_time" field.
	UpdateTime time.Time `json:"update_time,omitempty"`
	// Original _id from dataset
	OriginalID string `json:"original_id,omitempty"`
	// Product title
	Title string `json:"title,omitempty"`
	// Brand name
	Brand string `json:"brand,omitempty"`
	// Product description
	Description string `json:"description,omitempty"`
	// Original price
	ActualPrice string `json:"actual_price,omitempty"`
	// Discounted price
	SellingPrice string `json:"selling_price,omitempty"`
	// Discount percentage
	Discount string `json:"discount,omitempty"`
	// Main category
	Category string `json:"category,omitempty"`
	// Sub category
	SubCategory string `json:"sub_category,omitempty"`
	// OutOfStock holds the value of the "out_of_stock" field.
	OutOfStock bool `json:"out_of_stock,omitempty"`
	// Seller name
	Seller string `json:"seller,omitempty"`
	// Average rating
	AverageRating string `json:"average_rating,omitempty"`
	// Product image URLs
	Images []string `json:"images,omitempty"`
	// Dynamic product attributes
	ProductDetails []map[string]string `json:"product_details,omitempty"`
	// Product URL
	URL string `json:"url,omitempty"`
	// Flipkart product ID
	Pid string `json:"pid,omitempty"`
	// Style/sku code
	StyleCode string `json:"style_code,omitempty"`
	// When the data was crawled
	CrawledAt time.Time `json:"crawled_at,omitempty"`
	// Vector embeddings for semantic search
	Embedding []float32 `json:"embedding,omitempty"`
	// Keywords for full-text search
	SearchKeywords []string `json:"search_keywords,omitempty"`
	// Featured product
	Featured bool `json:"featured,omitempty"`
	// Number of views
	ViewCount int `json:"view_count,omitempty"`
	// Number of clicks
	ClickCount int `json:"click_count,omitempty"`
	// Price as integer for filtering
	PriceNumeric int `json:"price_numeric,omitempty"`
	// Rating as float for sorting
	RatingNumeric float64 `json:"rating_numeric,omitempty"`
	selectValues  sql.SelectValues
}

// scanValues returns the types for scanning values from sql.Rows.
func (*Product) scanValues(columns []string) ([]any, error) {
	values := make([]any, len(columns))
	for i := range columns {
		switch columns[i] {
		case product.FieldImages, product.FieldProductDetails, product.FieldEmbedding, product.FieldSearchKeywords:
			values[i] = new([]byte)
		case product.FieldOutOfStock, product.FieldFeatured:
			values[i] = new(sql.NullBool)
		case product.FieldRatingNumeric:
			values[i] = new(sql.NullFloat64)
		case product.FieldID, product.FieldViewCount, product.FieldClickCount, product.FieldPriceNumeric:
			values[i] = new(sql.NullInt64)
		case product.FieldOriginalID, product.FieldTitle, product.FieldBrand, product.FieldDescription, product.FieldActualPrice, product.FieldSellingPrice, product.FieldDiscount, product.FieldCategory, product.FieldSubCategory, product.FieldSeller, product.FieldAverageRating, product.FieldURL, product.FieldPid, product.FieldStyleCode:
			values[i] = new(sql.NullString)
		case product.FieldCreateTime, product.FieldUpdateTime, product.FieldCrawledAt:
			values[i] = new(sql.NullTime)
		default:
			values[i] = new(sql.UnknownType)
		}
	}
	return values, nil
}

// assignValues assigns the values that were returned from sql.Rows (after scanning)
// to the Product fields.
func (_m *Product) assignValues(columns []string, values []any) error {
	if m, n := len(values), len(columns); m < n {
		return fmt.Errorf("mismatch number of scan values: %d != %d", m, n)
	}
	for i := range columns {
		switch columns[i] {
		case product.FieldID:
			value, ok := values[i].(*sql.NullInt64)
			if !ok {
				return fmt.Errorf("unexpected type %T for field id", value)
			}
			_m.ID = int(value.Int64)
		case product.FieldCreateTime:
			if value, ok := values[i].(*sql.NullTime); !ok {
				return fmt.Errorf("unexpected type %T for field create_time", values[i])
			} else if value.Valid {
				_m.CreateTime = value.Time
			}
		case product.FieldUpdateTime:
			if value, ok := values[i].(*sql.NullTime); !ok {
				return fmt.Errorf("unexpected type %T for field update_time", values[i])
			} else if value.Valid {
				_m.UpdateTime = value.Time
			}
		case product.FieldOriginalID:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field original_id", values[i])
			} else if value.Valid {
				_m.OriginalID = value.String
			}
		case product.FieldTitle:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field title", values[i])
			} else if value.Valid {
				_m.Title = value.String
			}
		case product.FieldBrand:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field brand", values[i])
			} else if value.Valid {
				_m.Brand = value.String
			}
		case product.FieldDescription:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field description", values[i])
			} else if value.Valid {
				_m.Description = value.String
			}
		case product.FieldActualPrice:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field actual_price", values[i])
			} else if value.Valid {
				_m.ActualPrice = value.String
			}
		case product.FieldSellingPrice:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field selling_price", values[i])
			} else if value.Valid {
				_m.SellingPrice = value.String
			}
		case product.FieldDiscount:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field discount", values[i])
			} else if value.Valid {
				_m.Discount = value.String
			}
		case product.FieldCategory:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field category", values[i])
			} else if value.Valid {
				_m.Category = value.String
			}
		case product.FieldSubCategory:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field sub_category", values[i])
			} else if value.Valid {
				_m.SubCategory = value.String
			}
		case product.FieldOutOfStock:
			if value, ok := values[i].(*sql.NullBool); !ok {
				return fmt.Errorf("unexpected type %T for field out_of_stock", values[i])
			} else if value.Valid {
				_m.OutOfStock = value.Bool
			}
		case product.FieldSeller:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field seller", values[i])
			} else if value.Valid {
				_m.Seller = value.String
			}
		case product.FieldAverageRating:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field average_rating", values[i])
			} else if value.Valid {
				_m.AverageRating = value.String
			}
		case product.FieldImages:
			if value, ok := values[i].(*[]byte); !ok {
				return fmt.Errorf("unexpected type %T for field images", values[i])
			} else if value != nil && len(*value) > 0 {
				if err := json.Unmarshal(*value, &_m.Images); err != nil {
					return fmt.Errorf("unmarshal field images: %w", err)
				}
			}
		case product.FieldProductDetails:
			if value, ok := values[i].(*[]byte); !ok {
				return fmt.Errorf("unexpected type %T for field product_details", values[i])
			} else if value != nil && len(*value) > 0 {
				if err := json.Unmarshal(*value, &_m.ProductDetails); err != nil {
					return fmt.Errorf("unmarshal field product_details: %w", err)
				}
			}
		case product.FieldURL:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field url", values[i])
			} else if value.Valid {
				_m.URL = value.String
			}
		case product.FieldPid:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field pid", values[i])
			} else if value.Valid {
				_m.Pid = value.String
			}
		case product.FieldStyleCode:
			if value, ok := values[i].(*sql.NullString); !ok {
				return fmt.Errorf("unexpected type %T for field style_code", values[i])
			} else if value.Valid {
				_m.StyleCode = value.String
			}
		case product.FieldCrawledAt:
			if value, ok := values[i].(*sql.NullTime); !ok {
				return fmt.Errorf("unexpected type %T for field crawled_at", values[i])
			} else if value.Valid {
				_m.CrawledAt = value.Time
			}
		case product.FieldEmbedding:
			if value, ok := values[i].(*[]byte); !ok {
				return fmt.Errorf("unexpected type %T for field embedding", values[i])
			} else if value != nil && len(*value) > 0 {
				if err := json.Unmarshal(*value, &_m.Embedding); err != nil {
					return fmt.Errorf("unmarshal field embedding: %w", err)
				}
			}
		case product.FieldSearchKeywords:
			if value, ok := values[i].(*[]byte); !ok {
				return fmt.Errorf("unexpected type %T for field search_keywords", values[i])
			} else if value != nil && len(*value) > 0 {
				if err := json.Unmarshal(*value, &_m.SearchKeywords); err != nil {
					return fmt.Errorf("unmarshal field search_keywords: %w", err)
				}
			}
		case product.FieldFeatured:
			if value, ok := values[i].(*sql.NullBool); !ok {
				return fmt.Errorf("unexpected type %T for field featured", values[i])
			} else if value.Valid {
				_m.Featured = value.Bool
			}
		case product.FieldViewCount:
			if value, ok := values[i].(*sql.NullInt64); !ok {
				return fmt.Errorf("unexpected type %T for field view_count", values[i])
			} else if value.Valid {
				_m.ViewCount = int(value.Int64)
			}
		case product.FieldClickCount:
			if value, ok := values[i].(*sql.NullInt64); !ok {
				return fmt.Errorf("unexpected type %T for field click_count", values[i])
			} else if value.Valid {
				_m.ClickCount = int(value.Int64)
			}
		case product.FieldPriceNumeric:
			if value, ok := values[i].(*sql.NullInt64); !ok {
				return fmt.Errorf("unexpected type %T for field price_numeric", values[i])
			} else if value.Valid {
				_m.PriceNumeric = int(value.Int64)
			}
		case product.FieldRatingNumeric:
			if value, ok := values[i].(*sql.NullFloat64); !ok {
				return fmt.Errorf("unexpected type %T for field rating_numeric", values[i])
			} else if value.Valid {
				_m.RatingNumeric = value.Float64
			}
		default:
			_m.selectValues.Set(columns[i], values[i])
		}
	}
	return nil
}

// Value returns the ent.Value that was dynamically selected and assigned to the Product.
// This includes values selected through modifiers, order, etc.
func (_m *Product) Value(name string) (ent.Value, error) {
	return _m.selectValues.Get(name)
}

// Update returns a builder for updating this Product.
// Note that you need to call Product.Unwrap() before calling this method if this Product
// was returned from a transaction, and the transaction was committed or rolled back.
func (_m *Product) Update() *ProductUpdateOne {
	return NewProductClient(_m.config).UpdateOne(_m)
}

// Unwrap unwraps the Product entity that was returned from a transaction after it was closed,
// so that all future queries will be executed through the driver which created the transaction.
func (_m *Product) Unwrap() *Product {
	_tx, ok := _m.config.driver.(*txDriver)
	if !ok {
		panic("ent: Product is not a transactional entity")
	}
	_m.config.driver = _tx.drv
	return _m
}

// String implements the fmt.Stringer.
func (_m *Product) String() string {
	var builder strings.Builder
	builder.WriteString("Product(")
	builder.WriteString(fmt.Sprintf("id=%v, ", _m.ID))
	builder.WriteString("create_time=")
	builder.WriteString(_m.CreateTime.Format(time.ANSIC))
	builder.WriteString(", ")
	builder.WriteString("update_time=")
	builder.WriteString(_m.UpdateTime.Format(time.ANSIC))
	builder.WriteString(", ")
	builder.WriteString("original_id=")
	builder.WriteString(_m.OriginalID)
	builder.WriteString(", ")
	builder.WriteString("title=")
	builder.WriteString(_m.Title)
	builder.WriteString(", ")
	builder.WriteString("brand=")
	builder.WriteString(_m.Brand)
	builder.WriteString(", ")
	builder.WriteString("description=")
	builder.WriteString(_m.Description)
	builder.WriteString(", ")
	builder.WriteString("actual_price=")
	builder.WriteString(_m.ActualPrice)
	builder.WriteString(", ")
	builder.WriteString("selling_price=")
	builder.WriteString(_m.SellingPrice)
	builder.WriteString(", ")
	builder.WriteString("discount=")
	builder.WriteString(_m.Discount)
	builder.WriteString(", ")
	builder.WriteString("category=")
	builder.WriteString(_m.Category)
	builder.WriteString(", ")
	builder.WriteString("sub_category=")
	builder.WriteString(_m.SubCategory)
	builder.WriteString(", ")
	builder.WriteString("out_of_stock=")
	builder.WriteString(fmt.Sprintf("%v", _m.OutOfStock))
	builder.WriteString(", ")
	builder.WriteString("seller=")
	builder.WriteString(_m.Seller)
	builder.WriteString(", ")
	builder.WriteString("average_rating=")
	builder.WriteString(_m.AverageRating)
	builder.WriteString(", ")
	builder.WriteString("images=")
	builder.WriteString(fmt.Sprintf("%v", _m.Images))
	builder.WriteString(", ")
	builder.WriteString("product_details=")
	builder.WriteString(fmt.Sprintf("%v", _m.ProductDetails))
	builder.WriteString(", ")
	builder.WriteString("url=")
	builder.WriteString(_m.URL)
	builder.WriteString(", ")
	builder.WriteString("pid=")
	builder.WriteString(_m.Pid)
	builder.WriteString(", ")
	builder.WriteString("style_code=")
	builder.WriteString(_m.StyleCode)
	builder.WriteString(", ")
	builder.WriteString("crawled_at=")
	builder.WriteString(_m.CrawledAt.Format(time.ANSIC))
	builder.WriteString(", ")
	builder.WriteString("embedding=")
	builder.WriteString(fmt.Sprintf("%v", _m.Embedding))
	builder.WriteString(", ")
	builder.WriteString("search_keywords=")
	builder.WriteString(fmt.Sprintf("%v", _m.SearchKeywords))
	builder.WriteString(", ")
	builder.WriteString("featured=")
	builder.WriteString(fmt.Sprintf("%v", _m.Featured))
	builder.WriteString(", ")
	builder.WriteString("view_count=")
	builder.WriteString(fmt.Sprintf("%v", _m.ViewCount))
	builder.WriteString(", ")
	builder.WriteString("click_count=")
	builder.WriteString(fmt.Sprintf("%v", _m.ClickCount))
	builder.WriteString(", ")
	builder.WriteString("price_numeric=")
	builder.WriteString(fmt.Sprintf("%v", _m.PriceNumeric))
	builder.WriteString(", ")
	builder.WriteString("rating_numeric=")
	builder.WriteString(fmt.Sprintf("%v", _m.RatingNumeric))
	builder.WriteByte(')')
	return builder.String()
}

// Products is a parsable slice of Product.
type Products []*Product
